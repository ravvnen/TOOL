@startuml C4_Container_Simple
title TOOL System - Container Diagram

skinparam backgroundColor #FEFEFE
skinparam defaultTextAlignment center

actor "User" as user

rectangle "TOOL System" {
    rectangle "Agent.UI\n(React :3000)" as ui #LightGreen
    rectangle "TOOL API\n(.NET :5293)" as api #LightGreen
    rectangle "Promoter\nService" as promoter #LightGreen
    rectangle "Delta\nProjector" as projector #LightGreen
    database "SQLite\n+ FTS5" as db #LightBlue
}

queue "NATS JetStream" as nats #LightGray {
    queue "EVENTS" as events
    queue "DELTAS" as deltas
}

rectangle "GitHub" as github #LightGray
rectangle "Ollama\n(:11434)" as ollama #LightGray

' User flow
user --> ui : Browser
ui --> api : REST API

' LLM flow (API calls Ollama)
api --> ollama : Chat completions\nwith compiled rules

' GitHub webhook
github --> api : POST /api/v1/seed

' Event flow
api --> events : Publish
promoter --> events : Subscribe
promoter --> deltas : Publish
projector --> deltas : Subscribe
projector --> db : UPSERT

' Query flow
api --> db : FTS5 Query

note bottom of api
  **API Modules:**
  • SeedController
  • MemoryController
  • AdminController
  • ReplayController
  • AgentController (LLM)
end note

@enduml
