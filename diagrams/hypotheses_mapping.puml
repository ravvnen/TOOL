@startuml HypothesesMapping
title Research Hypotheses â†’ System Components Mapping

skinparam backgroundColor #FEFEFE
skinparam rectangle {
    roundCorner 15
}

' Hypotheses (left side)
rectangle "**H1: Correctness**\n\nDo rule-augmented answers\noutperform vanilla LLM?\n\n//Human evaluation (A vs B)//" as H1 #LightBlue

rectangle "**H2: Retrieval Quality**\n\nDoes FTS5 retrieve the\nright rules for a query?\n\n//Precision@5, MRR, NDCG//" as H2 #LightBlue

rectangle "**H3: Replayability**\n\nCan we reconstruct state\nfrom event history alone?\n\n//State Reconstruction Accuracy//" as H3 #LightBlue

rectangle "**H4: Freshness**\n\nHow fast do rule updates\nreach the UI?\n\n//End-to-end latency//" as H4 #LightBlue

rectangle "**H5: Consistency**\n\nDo multiple instances give\nthe same compiled memory?\n\n//Hash agreement rate//" as H5 #LightBlue

' System components (right side) with implementation status
rectangle "Memory Compiler\n+ Agent.UI + Ollama\n\nâœ… Implemented" as C1 #LightGreen

rectangle "FTS5 Search\n+ MemoryController\n\nâœ… Implemented" as C2 #LightGreen

rectangle "DELTAS Stream\n+ ReplayEngine\n\nâœ… Implemented" as C3 #LightGreen

rectangle "Delta Projector\n+ (SSE planned)\n\nðŸ”„ Partial" as C4 #LightYellow

rectangle "Shared DELTAS\n+ Multi-instance\n\nðŸ”„ Planned" as C5 #LightYellow

' Mappings
H1 --> C1 : tests
H2 --> C2 : tests
H3 --> C3 : tests
H4 --> C4 : tests
H5 --> C5 : tests

note bottom of H1
  **Experiment Status:**
  H1, H2: Need test prompts + human annotators
  H3: Can run now (ReplayEngine exists)
  H4: Need SSE implementation first
  H5: Need Docker multi-instance setup
end note

note bottom of C5
  **Implementation Priority:**
  1. H3 - already testable
  2. H4 - add SSE to projector
  3. H5 - Docker Compose setup
  4. H1/H2 - create evaluation dataset
end note

@enduml
